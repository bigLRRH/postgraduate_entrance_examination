# 计算机组成原理

## 1 计算机系统概述

### 1.1 计算机系统层次结构

#### 1.1.1 计算机系统的基本组成

**计算机系统**由**硬件**与**软件**两大部分组成。  
**硬件**是指计算机的实体部分。  
**软件**包括在硬件上的**程序**、**数据**以及**相关的文档**。  
**程序**是指挥计算机如何操作的一个指令序列。  
**数据**是指令操作的对象。

#### 1.1.2 计算机硬件的基本结构

冯·诺伊曼提出了“存储程序”的概念。  
“存储程序”：将程序和数据一起存放在存储器中。  
冯·诺伊曼机的基本思想：  
（1） 计算机由**运算器**、**存储器**、**控制器**、**输入设备**和**输出设备**五大部件组成。  
（2） 指令和数据以**同等地位**存储在存储器中，并可按地址寻访。  
（3） 指令和数据均用**二进制数**表示。  
（4） 指令**由操作码和地址码组成**，操作码用来表示操作的性质，地址码用来表示操作数在存储器中的位置。  
（5）指令在存储器内**按顺序存放**。通常，指令是按顺序执行的，在特定条件下，可根据运算结果或根据设定的条件改变执行顺序。  
*（6）机器以运算器为中心，输入输出设备与存储器间的数据传送通过运算器完成。

典型的冯·诺伊曼计算机是以运算器为中心的，现代的计算机已转化为以存储器为中心。  

五大部件的功能：  
运算器用来完成算术运算和逻辑运算,并将运算的中间结果暂存在运算器内。  
存储器用来存放数据和程序。  
控制器用来控制、指挥程序和数据的输入、运行以及处理运算结果。  
输入设备用来将人们熟悉的信息形式转换为机器能识别的信息形式。  
输出设备可将机器运算结果转换为人们熟悉的信息形式或其他系统所要求的信息形式。  
计算机的五大部件（又称五大子系统）在控制器的统一指挥下，有条不紊的自动工作。  

现代计算机的组成：  
**（1）中央处理器**  
中央处理器（简称CPU或处理器）是整个计算机的核心部件，主要用于指令的执行。  
CPU主要包含两种基本部件：**数据通路**和**控制器**。  
**数据通路**主要包含**算术逻辑单元**和**通用寄存器**等。  
算数逻辑单元（Arithmetic and Logic Unit, **ALU**，简称**算逻部件**）用来执行算数运算和逻辑运算。  
通用寄存器用来暂存指令所用的操作数或执行结果。  
**控制单元**（Control Unit，**CU**）用来解释存储器中的指令，并发出各种操作命令来执行命令。  
**（2）存储器**  
存储器分为**内存**和**外存**。  
内存包括**主存储器**（main memory，简称**主存**或**内存储器**）和**高速缓存**（cache）。  
CPU能直接访问的存储器是主存储器。  
外存（也称**辅存**、**辅助存储器**或**外存储器**）用于帮助主存储器记忆更多的信息，辅助存储器中的信息必须调入主存储器。  
**（3）外部设备和设备控制器**  
外部设备简称外设，也称为I/O设备，其中，I/O是输入/输出（input/output）的缩写。  
外设通常由**机械部分**和**电子部分**组成，这两部分通常是可以分开的，机械部分是外部设备本身，电子部分是控制外部设备的设备控制器。  
外设通过设备控制器连接到主机上，各种设备控制器统称为I/O控制器，I/O接口或I/O模块。  
**（4）总线**  
总线（bus）是传输信息的介质。

#### 1.1.3 计算机软件和硬件的关系

#### 1.1.4 计算机系统的工作原理

##### 1.1.4.1 “存储程序”工作方式

##### 1.1.4.2 高级语言程序与机器语言程序之间的转换

(1) 通过程序编辑软件得到hello.c文件（源程序）。hello.c在计算机中以ASCII字符方式存放。  
(2) 将hello.c进行预处理、编译、汇编和链接，最终生成可执行目标文件。  

**预处理：** 预处理器（cpp）队源程序中以字符#开头的命令进行处理。例如将#include命令后面的.h文件插入程序文件。输出结果还是一个源程序文件，以 **.i** 为扩展名。  
**编译：** 编译器（ccl）队预处理后的源程序进行编译,生成一个汇编语言源程序文件，以 **.s** 为扩展名。  
**汇编：** 汇编程序（as）队汇编语言源程序进行汇编，生成一个可重定位目标文件（relocatable object file），以 **.o** 为扩展名；它是一种二进制文件。  
**链接：** 链接程序（ld）将多个可重定位目标文件和标准库函数合并成一个可执行目标文件（executable object file，简称可执行文件），**无扩展名**。  

##### 1.1.4.3 程序和指令的执行过程

### 1.2 计算机性能指标

#### 1.2.1 吞吐量、响应时间

吞吐量（throughput）和响应时间（response time）是考量一个计算机系统性能的两个基本指标。  
**吞吐量**表示单位时间内所完成的工作量。  
**响应时间**也称为执行时间（execution time）或等待时间（latency），从作业提交到开始到作业完成所用的时间。  

#### 1.2.2 CPU时钟周期、主频、CPI、CPU执行时间

**CPU时钟周期（clock cycle，tick,clock tick，clock）**  
CPU主脉冲信号的宽度，CPU工作的最小时间单位。

**主频（clock rate，CPU时钟频率）**  
主脉冲信号的时钟频率，CPU时钟周期的倒数，衡量机器速度的重要参数。  
以赫兹（Hz）为单位。  

**CPI（cycles per instruction）**  
执行一条指令所需的时钟周期数。  
不同指令的功能不同，所需的时间周期数也可能不同。  
一条特点指令的CPI指执行该条指令所需的时钟周期数。  
对于一个程序或一台机器来说，其CPI指该程序或该机器指令集中的所有指令执行所需的平均时钟周期数。

**CPU执行时间**  
运行一个程序所花费的时间。  
计算机的性能可以看成CPU执行时间的倒数。  
两台计算机性能之比可以看出CPU执行时间之比的倒数。  

**公式：**  
$$
\begin{align*}
    CPU执行时间 &= 程序总时钟周期数 \div 时钟频率  \\
                &= 程序总时钟周期数 \times 时钟周期
\end{align*}
$$
$$
程序总时钟周期数=程序总指令条数 \times CPI
$$
$$
    程序总时钟周期数 = \sum_{i=1}^{n}(CPI_i \times C_i)
$$
其中，第$i$种指令的条数和CPI分别为$C_i$和$CPI_i$。
$$
    CPI = \sum_{i=1}^{n}(CPI_i \times F_i) = 程序总时钟周期数 \div 程序总指令条数
$$
其中，$F_i$表示第$i$种指令在程序中所占的比例。  

CPU执行时间度量公式中的时钟周期、指令条数、CPI三个因素相互制约。同一台计算机，指令条数最少的程序也不一定执行得最快。

***注：下表辅助记忆，非官方***  
| 名称        | 缩写 | 单位                                       |
| ----------- | ---- | ------------------------------------------ |
| 主频        | f    | 赫兹（Hz）                                 |
| CPI         | CPI  | 周期数每指令（cpi，cycle per instruction） |
| 指令条数    | I    | 条                                         |
| 周期        | T    | 秒（s）                                    |
| 周期数      | C    | 个（c,cycles）或（t，times）               |
| CPU执行时间 | t    | 秒（s）                                    |

#### 1.2.3 MIPS、MFLOPS、GFLOPS、TFLOPS、PFLOPS、EFLOPS、ZFLOPS

| 前缀   | Z         | E         | P         | T         | G        | M        | K        | 1      | m         | $\mu$     | n         | p          |
| ------ | --------- | --------- | --------- | --------- | -------- | -------- | -------- | ------ | --------- | --------- | --------- | ---------- |
| $10^n$ | $10^{21}$ | $10^{18}$ | $10^{15}$ | $10^{12}$ | $10^9$   | $10^6$   | $10^3$   | $10^0$ | $10^{-3}$ | $10^{-6}$ | $10^{-9}$ | $10^{-12}$ |
| $2^n$  | $2^{70}$  | $2^{60}$  | $2^{50}$  | $2^{40}$  | $2^{30}$ | $2^{20}$ | $2^{10}$ | $2^0$  | $2^{-10}$ | $2^{-20}$ | $2^{-30}$ | $2^{-40}$  |

## 2 数据的表示和运算

### 2.1 数制与编码

#### 2.1.1 进位计数制及其数据之间的相互转换

#### 2.1.2 定点数的编码表示

##### 2.1.2.1 真值和机器数

##### 补充

| 编码 | 定义                                                                              | 解释 |
| ---- | --------------------------------------------------------------------------------- | ---- |
| 原码 | $[x]_原 = \begin{cases}0,x&0\le x \lt^n \\2^n-x=2^n+x&2^n \lt x \le 0\end{cases}$ |      |
|      |                                                                                   |      |

$$
\begin{array}{|c|c|c|}
    \hline
    \text{编码}&\text{定义}&\text{解释}\\
    \hline
    \text{原码}&\begin{equation*}
      [x]_\text{原}=\begin{cases}
            0,x&0\le x \lt 2^n \\
            2^n-x=2^n+|x|&-2^n \lt x \le 0
        \end{cases}
    \end{equation*}
    &aaa \\
    \hline
\end{array}
$$

### 2.2 运算方法和运算电路

### 2.3 整数的表示和运算

#### 整数的表示

|                  |     |
| ---------------- | --- |
| 有符号整数的表示 |     |
|                  |     |

#### 整数的运算

##### 加

### 2.4 浮点数的表示和运算

## 3 存储器层次结构

## 4 指令系统

## 5 中央处理器（CPU）

## 6 总线和输入/输出系统
